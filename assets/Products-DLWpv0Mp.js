import{r as h,i as Y,m as V,y as X,u as ee,a as te,j as t,F as se,U as re,b as oe,s as ae,h as ce,d as ne,e as ie,f as le}from"./index-B8v1Da-l.js";import{S as j,R as de}from"./index-xg-p_p3a.js";import{S as pe}from"./Addslider-C4sTscom.js";import"./Carousel-BRWsBtdY.js";import"./Row-FmFIQNen.js";const ye=()=>{h.useEffect(()=>{window.scrollTo(0,0)},[]);const[N,S]=h.useState([]);h.useState([]);const[A,w]=h.useState(!0),v=Y();h.useState(!1);const[I,M]=h.useState({}),W=h.useContext(V),{selectedCategory:z,setSelectedCategory:D,accessoriesCategory:F,handleSearchInputChange:ue,setAccessoriesCategory:O,products:x,selectedPrice:u,selectedDistance:_,searchQuery:R,offer:y,setOffers:me,isNewProduct:Z}=W,{search:$}=X(),k=new URLSearchParams($);k.get("suggestion"),k.get("category");const b=ee(),P=te(e=>e.cart),q=(e,o,c)=>{const d=c||e.product_size.split(",")[0],s=e.product_color1.split(",")[0],n={...e,product_size:d,product_color1:s};b(ne(n)),b(ie({message:"Product added successfully!",index:o})),setTimeout(()=>{b(le())},1e3)},U=(e,o)=>{M(c=>({...c,[e]:o}))},B=(e,o)=>{const c=I[e.id]||e.product_size.split(",")[0];q(e,o,c)},[L,Q]=h.useState(Array(x.length).fill(!1)),G=(e,o)=>{const c=[...L];c[o]=!c[o],Q(c),b(oe(e)),b(ae({message:"Item added to wishlist!",index:o})),setTimeout(()=>{b(ce())},1e3)};if(z!==""){const e=`/category?selectedCategory=${encodeURIComponent(z)}`;v(e)}if(F!==""){const e=`/accessories?selectedCategory=${encodeURIComponent(F)}`;v(e)}const T=(e,o,c,d)=>{if(!e||!o||!c||!d)return 1/0;const s=J=>J*Math.PI/180,n=s(Number(e)),i=s(Number(o)),p=s(Number(c)),l=s(Number(d)),a=6371,r=p-n,g=l-i,m=Math.sin(r/2)*Math.sin(r/2)+Math.cos(n)*Math.cos(p)*Math.sin(g/2)*Math.sin(g/2),f=2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m));return(a*f).toFixed(2)};h.useEffect(()=>{O(""),D(""),setTimeout(()=>w(!1),2e3);let e=x;if(console.log(_),_!=="all"&&localStorage.getItem("user")){console.log(e);const d=JSON.parse(localStorage.getItem("user")),s=[d.lat,d.log],n=_||"5",i=e.filter(r=>!r.lat||!r.log);let p=x.filter(r=>T(...s,r.lat,r.log)>Number(n));const l={},a=[];x.forEach(r=>{T(...s,r.lat,r.log)<=Number(n)&&(l[r.category]?p.push(r):(a.push(r),l[r.category]=!0))}),e=[...a,...i,...p]}if(u!==""&&u!=="500 +"){console.log("SELCTED",u),console.log("below 500");const[d,s]=u.split("-").map(Number),n=e.filter(a=>{const r=parseInt(a.product_price);return r>=d&&r<=s}),i=e.filter(a=>parseInt(a.product_price)>s);let p=[...n,...i];p.sort((a,r)=>parseFloat(a.product_price)-parseFloat(r.product_price));const l=e.filter(a=>{if(u!==""){const[r]=u.split("-").map(Number);return parseInt(a.product_price)<r}else return!0});l.sort((a,r)=>parseFloat(a.product_price)-parseFloat(r.product_price)),e=[...p,...l]}if(u==="500 +"){console.log("above 500");const d=e.filter(n=>parseInt(n.product_price)>=500);d.sort((n,i)=>parseFloat(i.product_price)-parseFloat(n.product_price));const s=e.filter(n=>{if(u!==""){let i=500;return console.log("ELSE MIN",i),parseInt(n.product_price)<i}else return!0});console.log("ELSE REMAINING PROD",s),s.sort((n,i)=>parseFloat(n.product_price)-parseFloat(i.product_price)),e=[...d,...s]}if(y!==""){const d=parseInt(y),s=e.filter(n=>parseInt(n.offers)>=d);s.sort((n,i)=>parseFloat(n.offers)-parseFloat(i.offers)),e=s}const o=R.toLowerCase(),c=o.replace(/[^a-zA-Z0-9 ]/g,"");if(console.log("lowercase",o),o.trim()!==""){const d=e.filter(s=>{var m,f,C;const n=s.category.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""),i=s.product_title.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""),l=(s.product_title||"").toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""),a=((m=s.description)==null?void 0:m.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""))||"",r=((f=s.brand)==null?void 0:f.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""))||"",g=((C=s.client_name)==null?void 0:C.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,""))||"";return n.includes(c)||i.includes(c)||l.includes(c)||a.includes(c)||r.includes(c)||g.includes(c)});if(console.log("filtered productspage ",d),d.length>0){S(d);const s=setTimeout(()=>{w(!1)},2e3);return()=>clearTimeout(s)}else{if(e=x,u!==""&&u!=="500 +"){const[i,p]=u.split("-").map(Number),l=e.filter(m=>{const f=parseInt(m.product_price);return f>=i&&f<=p}),a=e.filter(m=>parseInt(m.product_price)>p);let r=[...l,...a];r.sort((m,f)=>parseFloat(m.product_price)-parseFloat(f.product_price));const g=e.filter(m=>{if(u!==""){const[f]=u.split("-").map(Number);return parseInt(m.product_price)<f}else return!0});g.sort((m,f)=>parseFloat(m.product_price)-parseFloat(f.product_price)),e=[...r,...g]}if(u==="500 +"){const i=e.filter(l=>parseInt(l.product_price)>=500);i.sort((l,a)=>parseFloat(a.product_price)-parseFloat(l.product_price));const p=e.filter(l=>{if(u!==""){let a=500;return console.log("ELSE MIN",a),parseInt(l.product_price)<a}else return!0});console.log("ELSE REMAINING PROD",p),p.sort((l,a)=>parseFloat(l.product_price)-parseFloat(a.product_price)),e=[...i,...p]}if(y!==""){const i=parseInt(y),p=e.filter(l=>parseInt(l.offers)>=i);p.sort((l,a)=>parseFloat(l.offers)-parseFloat(a.offers)),e=p}const s=E(e);S(s);const n=setTimeout(()=>{w(!1)},2e3);return()=>clearTimeout(n)}}else{const d=E(e);S(d);const s=setTimeout(()=>{w(!1)},2e3);return()=>clearTimeout(s)}},[x,R,u,y,z,_]);function E(e){return e.map(o=>({value:o,sort:Math.random()})).sort((o,c)=>o.sort-c.sort).map(({value:o})=>o)}console.log(x);const[H,K]=h.useState(window.innerWidth);return h.useEffect(()=>{const e=()=>{K(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsxs("div",{className:"container",children:[t.jsxs("h6",{children:["|",t.jsx(se,{className:"fs-3 p-1"}),"Find Near You"," "]}),t.jsxs("div",{className:"row",children:[t.jsx(re,{brand:"Test"}),t.jsx("div",{className:"col-md-10",children:t.jsx("div",{className:"row",children:A?Array.from({length:8}).map((e,o)=>t.jsxs("div",{className:"col-6 col-sm-4 col-md-6 col-lg-4 col-xl-3 py-2",children:[t.jsx(j,{height:200}),t.jsx(j,{height:20,width:"80%"}),t.jsx(j,{height:20,width:"60%"}),t.jsx(j,{height:20,width:"40%"}),t.jsx(j,{height:20,width:"30%"})]},o)):(N==null?void 0:N.length)===0?t.jsx("div",{className:"col-12 py-2 text-center fs-4 fw-semibold",id:"sections",children:"No Products Found"}):N.map((e,o)=>t.jsx("div",{className:"col-6 col-sm-3 py-2 px-2",children:t.jsxs("div",{className:"product-card",children:[t.jsxs("div",{className:"product-image",style:{position:"relative"},children:[t.jsx("a",{href:`/${e.pid}`,target:"_blank",style:{textDecoration:"none",color:"black"},children:t.jsx("img",{src:e.product_image1,style:{width:"100%"},alt:"Product 1"})}),t.jsx("span",{style:{position:"absolute",top:"5px",right:"5px",background:"yellow",padding:"5px",fontSize:"10px"},children:"Live Image"}),t.jsxs("div",{className:"offer-tag text-center p-1 text-bold mt-2",style:{position:"absolute",bottom:"15px",right:"15px",fontSize:"0.8rem",padding:"1rem",textDecorationColor:"HighlightText",border:"2px solid",borderRadius:"50px",fontWeight:"bold",backgroundColor:e.offers==="0"?"":"#e8d9b7",opacity:e.offers==="0"?0:.5},children:[e.offers,"% Off"]})]}),t.jsxs("div",{className:"product-content d-flex flex-column gap-1 pt-3  px-1 pb-3  ",children:[t.jsxs("div",{style:{fontSize:"14px"},className:"d-flex justify-content-between",children:[t.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",justifyContent:"space-between"},children:[t.jsx("span",{className:"",children:e.client_name}),t.jsxs("span",{children:[t.jsx(de,{style:{marginRight:"5px"}}),t.jsx("span",{style:{color:"orange"},children:"36 min"})]})]}),Z(e.date)&&t.jsx("span",{className:"ms-4",style:{color:"#ffc107"},children:"New"})]}),t.jsx("a",{href:`/${e.product_id}`,target:"_blank",style:{textDecoration:"none",color:"black"},className:"fw-semibold",children:H<=1024?e.product_name&&e.product_name.length>15?e.product_name.substring(0,15)+"...":e.product_name:e.product_name&&e.product_name.length>23?e.product_name.substring(0,23)+"...":e.product_name}),t.jsxs("div",{className:"flex-container ",children:[t.jsxs("h6",{className:"fs-9 text-start",children:[t.jsx("span",{className:"fw-semibold",children:e.product_title})," ","|",t.jsx("span",{className:"fw-bold",children:" Color:"})," ",e.product_color1," |",t.jsxs("span",{className:"fw-bold",children:[" ",e.material]})," "]}),t.jsxs("h5",{className:"mt-1 flext-item  ",style:{fontSize:"1rem"},children:["₹",e.product_price,t.jsx("span",{className:"text-decoration-line-through text-muted  fw-light",style:{fontSize:"0.813rem"},children:"599"}),t.jsx("span",{className:"text-muted",style:{fontSize:"10px"},children:" "})]}),t.jsxs("div",{children:[t.jsx("span",{className:" fw-bold",style:{fontSize:"0.875rem"},children:"Available size:"})," ",e.product_size.includes(",")?t.jsx("select",{className:"px-1",style:{backgroundColor:"#d9725f",fontSize:"0.875rem",borderRadius:"5px"},onChange:c=>U(e.id,c.target.value),value:I[e.id]||e.product_size.split(",")[0],children:e.product_size.split(",").map((c,d)=>t.jsx("option",{value:c,children:c},d))}):t.jsx("span",{className:"px-1",style:{backgroundColor:"#d9725f",fontSize:"0.875rem"},children:e.product_size})]}),t.jsx("div",{children:t.jsxs("span",{className:" fw-bold",style:{fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[e.product_stock<=1?"Only one left":"In stock",t.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#d9725f"}})]})})]})]}),P.snackbar.open&&P.snackbar.index===o&&t.jsx("div",{style:{fontSize:"12px"},className:"border text-center rounded w-75 mx-auto",children:P.snackbar.message}),t.jsxs("div",{className:"cart-btn px-1",children:[t.jsx("button",{className:"btn btn-primary my-2   px-2 ",onClick:()=>B(e,o),children:"Add to cart"}),t.jsx("button",{className:`btn ${L[o]?"btn-success":"btn-primary"} w-21 my-2`,onClick:()=>G(e,o),children:"❤"})]})]})},o))})}),t.jsx(pe,{})]})]}),t.jsx("br",{})]})};export{ye as default};
